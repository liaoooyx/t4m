<!--
=========================================================
* Argon Dashboard - v1.2.0
=========================================================
* Product Page: https://www.creative-tim.com/product/argon-dashboard


* Copyright  Creative Tim (http://www.creative-tim.com)
* Coded by www.creative-tim.com



=========================================================
* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Start your development with a Dashboard for Bootstrap 4.">
	<meta name="author" content="Creative Tim">
	<title>Argon Dashboard - Free Dashboard for Bootstrap 4</title>
	<!-- Favicon -->
	<link rel="icon" th:href="@{/assets/img/brand/favicon.png}" type="image/png">
	<!-- Fonts -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
	<!-- Icons -->
	<link rel="stylesheet" th:href="@{/assets/vendor/nucleo/css/nucleo.css}" type="text/css">
	<link rel="stylesheet" th:href="@{/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css}" type="text/css">
	<!-- Page plugins -->
	<!-- Argon CSS -->
	<link rel="stylesheet" th:href="@{/assets/css/argon.css?v=1.2.0}" type="text/css">
	<script th:src="@{/assets/vendor/echart/dist/echarts.js}"></script>
	<script th:src="@{/assets/js/vue.js}"></script>
	<style>
		.card-table {
			max-height: 21rem;
		}
		
		/*custom bootstrap .dropdown-menu for max height*/
		.dropdown-menu {
			max-height: 20rem;
			overflow: auto;
		}
	</style>
</head>

<body>
<!-- Sidenav -->
<nav th:replace="fragments/navigation :: sidnav(id)"></nav>

<!-- Main content -->
<div class="main-content" id="panel">
	<!-- Topnav -->
	<nav class="navbar navbar-top navbar-expand navbar-dark bg-primary border-bottom">
		<div class="container-fluid">
			<div class="collapse navbar-collapse row justify-content-between" id="navbarSupportedContent">
				
				<!-- Path nav -->
				<div class="row col-auto align-items-center ">
					<h6 class="h2 text-white d-inline-block mb-0 col-auto">Overview</h6>
					<nav aria-label="breadcrumb col-auto" class="d-none d-md-inline-block ml-md-4">
						<ol class="breadcrumb breadcrumb-links breadcrumb-dark py-2 mb-0">
							<li class="breadcrumb-item"><a href="#"><i class="fas fa-home"></i></a></li>
							<li class="breadcrumb-item"><a href="#">Dashboards</a></li>
							<li class="breadcrumb-item active" aria-current="page">Overview</li>
						</ol>
					</nav>
				</div>
				
				<div class="row col-auto justify-content-end align-items-center m-0">
					<!-- Search form -->
					<!--					<div class="col-auto">-->
					<!--						<form class="navbar-search navbar-search-light form-inline" id="navbar-search-main">-->
					<!--							<div class="form-group mb-0">-->
					<!--								<div class="input-group input-group-alternative input-group-merge">-->
					<!--									<div class="input-group-prepend">-->
					<!--										<span class="input-group-text"><i class="fas fa-search"></i></span>-->
					<!--									</div>-->
					<!--									<input class="form-control" placeholder="Search" type="text">-->
					<!--								</div>-->
					<!--							</div>-->
					<!--							<button type="button" class="close" data-action="search-close" data-target="#navbar-search-main"-->
					<!--							        aria-label="Close">-->
					<!--								<span aria-hidden="true">×</span>-->
					<!--							</button>-->
					<!--						</form>-->
					<!--					</div>-->
					<!-- Navbar links -->
					<div class="col-auto">
						<ul class="navbar-nav align-items-center">
							<li class="nav-item d-xl-none">
								<!-- Sidenav toggler -->
								<div class="pr-2 sidenav-toggler sidenav-toggler-dark" data-action="sidenav-pin"
								     data-target="#sidenav-main">
									<div class="sidenav-toggler-inner">
										<i class="sidenav-toggler-line"></i>
										<i class="sidenav-toggler-line"></i>
										<i class="sidenav-toggler-line"></i>
									</div>
								</div>
							</li>
						</ul>
					</div>
				</div>
			
			</div>
		</div>
	</nav>
	
	<!-- Header -->
	<div class="header bg-primary pb-6">
		<div class="container-fluid">
			<div class="header-body"
			     th:with="currentProjectInfo = ${projectList.get(projectList.size()-1)}, preProjectInfo = ${projectList.get(projectList.size()-2)}">
				<!-- Card stats -->
				<div class="row pt-3">
					<!-- Module Card -->
					<div class="col-xl-4 col-md-4">
						<div class="card card-stats">
							<!-- Card body -->
							<div class="card-body">
								<!-- Current Info -->
								<div class="row">
									<div class="col">
										<h5 class="card-title text-uppercase text-muted mb-0">Number Of Modules</h5>
										<span class="h2 font-weight-bold mb-0" th:text="${currentProjectInfo.getModuleList().size()}">
										</span>
									</div>
								</div>
								<!-- Update Info -->
								<p class="mt-3 mb-0 text-sm" th:inline="text"
								   th:with="numDiff=${currentProjectInfo.getModuleList().size() - preProjectInfo.getModuleList().size()}">
									<span class="text-success mr-2" th:if="${numDiff} ge '0'">
										<i class="fa fa-arrow-up"></i>[[${numDiff}]]
									</span>
									<span class="text-danger mr-2" th:if="${numDiff} lt '0'">
										<i class="fa fa-arrow-down"></i>[[${numDiff}]]
									</span>
									<span class="text-nowrap">
										Since [[${#dates.format(currentProjectInfo.getCreateDate(), 'yyyy-MM-dd HH:mm:ss')}]]
									</span>
								</p>
							</div>
						</div>
					</div>
					<!-- Package Card -->
					<div class="col-xl-4 col-md-4">
						<div class="card card-stats">
							<!-- Card body -->
							<div class="card-body">
								<!-- Current Info -->
								<div class="row">
									<div class="col">
										<h5 class="card-title text-uppercase text-muted mb-0">Number Of Packages</h5>
										<span class="h2 font-weight-bold mb-0"
										      th:text="${currentProjectInfo.getPackageList().size()}"></span>
									</div>
								</div>
								<!-- Update Info -->
								<p class="mt-3 mb-0 text-sm" th:inline="text"
								   th:with="numDiff=${currentProjectInfo.getPackageList().size() - preProjectInfo.getPackageList().size()}">
									<span class="text-success mr-2" th:if="${numDiff} ge '0'">
										<i class="fa fa-arrow-up"></i>[[${numDiff}]]
									</span>
									<span class="text-danger mr-2" th:if="${numDiff} lt '0'">
										<i class="fa fa-arrow-down"></i>[[${numDiff}]]
									</span>
									<span class="text-nowrap">
										Since [[${#dates.format(currentProjectInfo.getCreateDate(), 'yyyy-MM-dd HH:mm:ss')}]]
									</span>
								</p>
							</div>
						</div>
					</div>
					<!-- Class Card -->
					<div class="col-xl-4 col-md-4">
						<div class="card card-stats">
							<!-- Card body -->
							<div class="card-body">
								<!-- Current Info -->
								<div class="row">
									<div class="col">
										<h5 class="card-title text-uppercase text-muted mb-0">Number Of Classes + (InnerClasses)</h5>
										<span class="h2 font-weight-bold mb-0"
										      th:text="${currentProjectInfo.getClassList().size()}+' + ('+${currentProjectInfo.getInnerClassList().size()}+')'"></span>
									</div>
								</div>
								<!-- Update Info -->
								<p class="mt-3 mb-0 text-sm" th:inline="text"
								   th:with="numDiff=${currentProjectInfo.getClassList().size() - preProjectInfo.getClassList().size()}, numDiff2=${currentProjectInfo.getInnerClassList().size() - preProjectInfo.getInnerClassList().size()}">
									<span class="text-success mr-0" th:if="${numDiff} ge '0'">
										<i class="fa fa-arrow-up"></i>[[${numDiff}]]
									</span>
									<span class="text-danger mr-0" th:if="${numDiff} lt '0'">
										<i class="fa fa-arrow-down"></i>[[${numDiff}]]
									</span>
									<span>&nbsp;+&nbsp;(</span>
									<span class="text-success ml-0" th:if="${numDiff2} ge '0'">
										<i class="fa fa-arrow-up"></i>[[${numDiff2}]]
									</span>
									<span class="text-danger ml-0" th:if="${numDiff2} lt '0'">
										<i class="fa fa-arrow-down"></i>[[${numDiff2}]]
									</span>
									<span>)</span>
									<span class="text-nowrap ml-2">
										Since [[${#dates.format(currentProjectInfo.getCreateDate(), 'yyyy-MM-dd HH:mm:ss')}]]
									</span>
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	
	<!-- Page content -->
	<div class="container-fluid mt--6" th:with="currentProjectInfo = ${projectList.get(projectList.size()-1)}">
		<div class="row">
			<!-- chart -->
			<div class="col-xl-12">
				<div class="card">
					<div class="card-header bg-transparent">
						<div class="row align-items-center">
							<div class="col">
								<h6 class="text-muted text-uppercase ls-1 mb-1">Overview</h6>
								<h5 class="h3 mb-0">Sales value</h5>
							</div>
							<div class="col">
								<ul class="nav nav-pills justify-content-end">
									<li class="nav-item mr-2 mr-md-0">
										<a href="#" class="nav-link py-2 px-3 active" data-toggle="tab"
										   onclick="changeXAxisType('category')">
											<span class="d-none d-md-block">Category</span>
											<span class="d-md-none">C</span>
										</a>
									</li>
									<li class="nav-item">
										<a href="#" class="nav-link py-2 px-3" data-toggle="tab" onclick="changeXAxisType('time')">
											<span class="d-none d-md-block">Time</span>
											<span class="d-md-none">T</span>
										</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
					<div id="chart" class="card-body pb-4 pr-4 pl-0 pt-0 col-12" style="height:400px;">
					</div>
					<script type="text/javascript" th:inline="javascript">
              // 指定图表的配置项和数据
              var option = {
                  dataset: {
                      // 提供一份数据。
                      source: [
                          ['level'].concat(/*[[${timeRecords}]]*/),
                          ['Module Number'].concat(/*[[${moduleRecords}]]*/),
                          ['Package Number'].concat(/*[[${packageRecords}]]*/),
                          ['Class Number'].concat(/*[[${classRecords}]]*/),
                          ['Class + Inner Class Number'].concat(/*[[${classAndInnerClassRecords}]]*/)
                      ]
                  },
                  // 声明多个 bar 系列，默认情况下，每个系列会自动对应到 dataset 的每一列。
                  series: [
                      {type: 'line', encode: {x: 0, y: 1, seriesName: 1}, seriesLayoutBy: 'row'},
                      {type: 'line', encode: {x: 0, y: 2, seriesName: 2}, seriesLayoutBy: 'row'},
                      {type: 'line', encode: {x: 0, y: 3, seriesName: 3}, seriesLayoutBy: 'row'},
                      {type: 'line', encode: {x: 0, y: 4, seriesName: 4}, seriesLayoutBy: 'row'}
                  ],
                  legend: {},
                  // 声明一个 X 轴，类目轴（category）。默认情况下，类目轴对应到 dataset 第一列。
                  xAxis: {
                      type: 'category'
                  },
                  yAxis: {},
                  tooltip: {
                      trigger: 'axis',
                      axisPointer: {
                          snap: true,
                          type: "line",
                      }
                  },
                  dataZoom: [
                      {
                          type: 'slider',
                          xAxisIndex: 0,
                          start: 20,
                          end: 100
                      },
                      {
                          type: 'inside',
                          xAxisIndex: 0,
                          start: 20,
                          end: 100
                      },
                      {
                          type: 'slider',
                          yAxisIndex: 0,
                          start: 0,
                          end: 100
                      }
                  ],
              };
              // 基于准备好的dom，初始化echarts实例
              var myChart = echarts.init(document.getElementById('chart'));
              // 使用刚指定的配置项和数据显示图表。
              myChart.setOption(option);

              myChart.on('click', function (params) {
                  // 控制台打印数据的名称
                  console.log(params.name);
              });

              function changeXAxisType(type) {
                  myChart.setOption({
                      xAxis: {
                          type: type
                      },
                  });
              }
					
					</script>
				</div>
			</div>
		</div>
		
		<div class="row">
			
			<div class="col-xl-12">
				<div class="card-header border-0">
					<div class="row align-items-center">
						<div class="col-auto">
							<h6 class="text-uppercase text-muted ls-1 mb0">Project Information</h6>
							
							<!-- dropdown -->
							<div class="nav-item dropdown">
								<a class="nav-link pr-0" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
								   aria-expanded="false">
											<span class="h3 mb-0 mr-2"
											      th:text="${#dates.format(currentProjectInfo.getCreateDate(), 'yyyy-MM-dd HH:mm:ss')}"></span>
									<i class="fas fa-caret-down"></i>
								</a>
								<div class="dropdown-menu">
									<!--											<div class="dropdown-header noti-title">-->
									<!--												<h6 class="text-overflow m-0">History Record</h6>-->
									<!--											</div>-->
									<a class="dropdown-item" href="javascript:void(0);"
									   th:each="timeRecord,timeRecordStat : ${timeRecords}"
									   th:onclick="updateProjectInfomation([[${timeRecordStat.index}]])">
										<span th:text="${timeRecord}"></span>
									</a>
								</div>
							</div>
						
						</div>
					
					</div>
				</div>
			</div>
			
			<!-- 这部分的动态更新由vue.js支持，模板语法有thymeleaf支持 -->
			<!-- 修改代码后，需要同步更新至templates/fragments/overview/project_info_overview.html -->
			<div id="project_info_overview" v-html="project_info_fragment">
				<!-- module -->
				<div class="col-xl-12">
					<div class="card">
						<div class="table-responsive card-table">
							<table class="table align-items-center table-flush">
								<thead class="thead-light">
								<tr>
									<th scope="col">Module</th>
									<th scope="col">Package Number</th>
									<th scope="col">Class + (InnerClass) Number</th>
								</tr>
								</thead>
								<tbody th:each="moduleMap : ${moduleMapList}">
								<tr th:object="${moduleMap}"
								    th:class="(*{type} eq 'new')? 'text-success' : ((*{type} eq 'delete')? 'text-danger': '')"
								    th:styleappend="(*{type} eq 'delete')? 'text-decoration: line-through;' : ''">
									<th scope="row" th:text="(*{type} eq 'new') ? '(new) '+ *{moduleName} : *{moduleName}"></th>
									<td th:text="*{numOfPkg}">num of pkg</td>
									<td th:text="*{numOfClass}+' + ('+*{numOfInnerClass}+')'">num of class</td>
								</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<!-- package -->
				<div class="col-xl-12">
					<div class="card">
						<div class="card-header border-0 py-2">
						</div>
						<div class="table-responsive card-table">
							<table class="table align-items-center table-flush">
								<thead class="thead-light">
								<tr>
									<th scope="col">Package</th>
									<th scope="col">of Module</th>
									<th scope="col">Class + (InnerClass) Number</th>
								</tr>
								</thead>
								<tbody th:each="packageMap : ${packageMapList}">
								<tr th:object="${packageMap}"
								    th:class="(*{type} eq 'new')? 'text-success' : ((*{type} eq 'delete')? 'text-danger': '')"
								    th:styleappend="(*{type} eq 'delete')? 'text-decoration: line-through;' : ''">
									<th scope="row" th:text="(*{type} eq 'new') ? '(new) '+ *{packageName} : *{packageName}"></th>
									<td th:text="*{packageInfo.getModuleInfo().getRelativePath()}"></td>
									<td th:text="*{numOfClass}+' + ('+*{numOfInnerClass}+')'"></td>
								</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<!-- class -->
				<div class="col-xl-12">
					<div class="card">
						<div class="card-header border-0 py-2">
						</div>
						<div class="table-responsive card-table">
							<!-- Projects table -->
							<table class="table align-items-center table-flush">
								<thead class="thead-light">
								<tr>
									<th scope="col">Class</th>
									<th scope="col">of Package</th>
									<th scope="col">of Module</th>
									<th scope="col">Field Number</th>
									<th scope="col">Method Number</th>
									<th scope="col">SLOC</th>
								</tr>
								</thead>
								<tbody th:each="classMap : ${classMapList}">
								<tr th:object="${classMap}"
								    th:class="(*{type} eq 'new')? 'text-success' : ((*{type} eq 'delete')? 'text-danger': '')"
								    th:styleappend="(*{type} eq 'delete')? 'text-decoration: line-through;' : ''">
									<th scope="row" th:text="(*{type} eq 'new') ? '(new) '+ *{className} : *{className}"></th>
									<td th:text="*{classInfo.getPackageInfo().getFullyQualifiedName()}"></td>
									<td th:text="*{classInfo.getPackageInfo().getModuleInfo().getRelativePath()}"></td>
									<td th:text="*{numOfFields}"></td>
									<td th:text="*{numOfMethods}"></td>
									<td th:text="*{SLOC}"></td>
								</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		
		</div>
		
		<script>
        function updateProjectInfomation(index) {
            $.get("/dashboard/overview/select/" + index, function (data) {
                if ("undefined" == typeof vm.$el) {
                    vm.project_info_fragment = data;
                    // 挂载vue实例到DOM上，继续声明周期
                    vm.$mount('#project_info_overview');
                }
                vm.project_info_fragment = data;
            });
        }

        var vm = new Vue({
            // Vue实例将在created后停止声明周期，等到调用updateProjectInfomation()时才继续
            // el: '#project_info_overview',
            data: {
                project_info_fragment: ""
            }
        })
		</script>
		
		<!-- Footer -->
		<footer th:replace="fragments/footer :: footer"></footer>
	</div>
</div>
<!-- Argon Scripts -->
<!-- Core -->
<script th:src="@{/assets/vendor/jquery/dist/jquery.min.js}"></script>
<script th:src="@{/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/assets/vendor/js-cookie/js.cookie.js}"></script>
<script th:src="@{/assets/vendor/jquery.scrollbar/jquery.scrollbar.min.js}"></script>
<script th:src="@{/assets/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js}"></script>
<!-- Optional JS -->
<script th:src="@{/assets/vendor/chart.js/dist/Chart.min.js}"></script>
<script th:src="@{/assets/vendor/chart.js/dist/Chart.extension.js}"></script>
<!-- Argon JS -->
<script th:src="@{/assets/js/argon.js?v=1.2.0}"></script>

</body>

</html>
